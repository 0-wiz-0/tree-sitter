build: false
install:
  # Install rust
  - appveyor DownloadFile https://win.rustup.rs/ -FileName rustup-init.exe
  - rustup-init -yv --default-toolchain stable
  - set PATH=%PATH%;C:\Users\appveyor\.cargo\bin
  - rustc -vV
  - cargo -vV

  # Install dependencies
  - git submodule update --init

environment:
  RUST_BACKTRACE: full

test_script:
  # Fetch and regenerate the fixture parsers
  - script\fetch-fixtures.cmd
  - cargo build --release
  - script\regenerate-fixtures.cmd

  # Run tests
  - set TREE_SITTER_TEST=1
  - cargo test

branches:
  only:
    - master

cache:
  - target
  - test\fixtures\grammars
  - C:\Users\appveyor\.cargo
  - C:\cargo\registry
  - C:\cargo\git
